---
title: Schema Reference
description: Complete technical specification of all configuration fields
---

<Note>
  **Auto-generated from Zod Schema**

Last updated: 2025-12-22

This page provides the complete technical specification of all configuration fields. For explanations and best practices, see the [Configuration](/configuration) guide.

</Note>

## Root Configuration

| Field     | Type       | Required |
| --------- | ---------- | -------- |
| `version` | `"2.0"`    | Yes      |
| `agents`  | `Agent[]`  | Yes      |

```yaml
version: '2.0'
agents:
  - id: engineer
    # ...
```

## Agent

| Field         | Type           | Required | Description |
| ------------- | -------------- | -------- | ----------- |
| `id`          | `string`       | Yes      | Unique identifier (lowercase, numbers, hyphens) |
| `name`        | `string`       | Yes      | Display name |
| `description` | `string`       | No       | Brief description |
| `label`       | `string`       | No       | Filter: only handle issues with this label |
| `team`        | `string`       | No       | Filter: only handle issues in this team |
| `systemPrompt`| `SystemPrompt` | No       | Agent behavior instructions |
| `runner`      | `RunnerConfig` | Yes      | Execution configuration |

## SystemPrompt

Union type - either a string or a preset object:

**String format:**
```yaml
systemPrompt: |
  You are a software engineer...
```

**Preset format:**

| Field    | Type             | Required | Description |
| -------- | ---------------- | -------- | ----------- |
| `type`   | `"preset"`       | Yes      | Must be "preset" |
| `preset` | `"claude_code"`  | Yes      | Preset name |
| `append` | `string`         | No       | Additional instructions |

```yaml
systemPrompt:
  type: preset
  preset: claude_code
  append: |
    Project-specific instructions...
```

## RunnerConfig

| Field   | Type                   | Required | Description |
| ------- | ---------------------- | -------- | ----------- |
| `claude`| `ClaudeRunnerOptions`  | No       | Claude Agent SDK options |

Future: Additional runner types (gemini, codex) may be added.

## ClaudeRunnerOptions

| Field                  | Type                | Required | Description |
| ---------------------- | ------------------- | -------- | ----------- |
| `model`                | `string`            | No       | Claude model override |
| `allowedTools`         | `string[]`          | No       | Tools the agent can use |
| `disallowedTools`      | `string[]`          | No       | Tools to block |
| `mcpServers`           | `McpServerMap`      | No       | MCP server configurations |
| `permissionMode`       | `PermissionMode`    | No       | How to handle permissions |
| `maxTurns`             | `number`            | No       | Max conversation turns |
| `maxBudgetUsd`         | `number`            | No       | Max API spend in USD |
| `maxThinkingTokens`    | `number`            | No       | Max tokens for thinking |
| `hooks`                | `Hooks`             | No       | Lifecycle hooks |
| `sandbox`              | `SandboxSettings`   | No       | Sandbox configuration |
| `settingSources`       | `SettingSource[]`   | No       | Setting sources to use |
| `additionalDirectories`| `string[]`          | No       | Additional dirs for agent access |
| `env`                  | `Record<string, string>` | No  | Agent-specific env vars |
| `betas`                | `string[]`          | No       | Beta features to enable |

## PermissionMode

Enum with values:

| Value               | Description |
| ------------------- | ----------- |
| `default`           | Standard permission prompts |
| `acceptEdits`       | Auto-accept file edits |
| `bypassPermissions` | Skip all permission checks |
| `plan`              | Plan-only mode (no execution) |

## Available Tools

Tools from Claude Agent SDK:

| Tool        | Description |
| ----------- | ----------- |
| `Read`      | Read file contents |
| `Write`     | Create new files |
| `Edit`      | Edit existing files |
| `Glob`      | Find files by pattern |
| `Grep`      | Search file contents |
| `Bash`      | Execute shell commands |
| `Task`      | Spawn sub-agents |
| `WebFetch`  | Fetch web content |
| `WebSearch` | Search the web |

## McpServerMap

Map of server name to configuration:

```yaml
mcpServers:
  server-name:
    type: stdio
    # ...
```

### McpServer (Union Type)

Three variants based on connection type:

#### stdio (command-based)

| Field     | Type                  | Required | Description |
| --------- | --------------------- | -------- | ----------- |
| `type`    | `"stdio"` or omitted  | No       | Defaults to stdio |
| `command` | `string`              | Yes      | Command to execute |
| `args`    | `string[]`            | No       | Command arguments |
| `env`     | `Record<string, string>` | No    | Environment variables |

```yaml
mcpServers:
  github:
    type: stdio
    command: npx
    args: ["-y", "@modelcontextprotocol/server-github"]
    env:
      GITHUB_TOKEN: '${GITHUB_TOKEN}'
```

#### sse (Server-Sent Events)

| Field     | Type                  | Required | Description |
| --------- | --------------------- | -------- | ----------- |
| `type`    | `"sse"`               | Yes      | Must be "sse" |
| `url`     | `string`              | Yes      | SSE endpoint URL |
| `headers` | `Record<string, string>` | No    | HTTP headers |

```yaml
mcpServers:
  linear:
    type: sse
    url: https://mcp.linear.app/sse
    headers:
      Authorization: 'Bearer ${LINEAR_TOKEN}'
```

#### http (HTTP POST)

| Field     | Type                  | Required | Description |
| --------- | --------------------- | -------- | ----------- |
| `type`    | `"http"`              | Yes      | Must be "http" |
| `url`     | `string`              | Yes      | HTTP endpoint URL |
| `headers` | `Record<string, string>` | No    | HTTP headers |

```yaml
mcpServers:
  custom:
    type: http
    url: https://api.example.com/mcp
    headers:
      X-API-Key: '${API_KEY}'
```

## Hooks

Map of hook event to hook matchers:

| Event                | Description |
| -------------------- | ----------- |
| `PreToolUse`         | Before a tool is executed |
| `PostToolUse`        | After a tool completes |
| `PostToolUseFailure` | After a tool fails |
| `UserPromptSubmit`   | When user submits input |
| `Stop`               | When agent stops |
| `SubagentStart`      | When sub-agent starts |
| `SubagentStop`       | When sub-agent stops |
| `PreCompact`         | Before context compaction |
| `SessionStart`       | When session begins |
| `SessionEnd`         | When session ends |
| `Notification`       | On notifications |
| `PermissionRequest`  | On permission requests |

### HookMatcher

| Field    | Type            | Required | Description |
| -------- | --------------- | -------- | ----------- |
| `matcher`| `string`        | No       | Tool name pattern to match |
| `hooks`  | `HookCommand[]` | Yes      | Commands to execute |

### HookCommand

| Field     | Type         | Required | Description |
| --------- | ------------ | -------- | ----------- |
| `type`    | `"command"`  | Yes      | Must be "command" |
| `command` | `string`     | Yes      | Shell command to run |
| `timeout` | `number`     | No       | Timeout in milliseconds |

```yaml
hooks:
  PreToolUse:
    - matcher: 'Bash'
      hooks:
        - type: command
          command: './validate-bash.sh'
          timeout: 5000
  SessionEnd:
    - hooks:
        - type: command
          command: './cleanup.sh'
```

## SandboxSettings

| Field                      | Type                      | Required | Description |
| -------------------------- | ------------------------- | -------- | ----------- |
| `enabled`                  | `boolean`                 | No       | Enable sandbox mode |
| `autoAllowBashIfSandboxed` | `boolean`                 | No       | Auto-allow bash in sandbox |
| `excludedCommands`         | `string[]`                | No       | Commands to block |
| `allowUnsandboxedCommands` | `boolean`                 | No       | Allow unsandboxed commands |
| `network`                  | `SandboxNetwork`          | No       | Network restrictions |
| `ignoreViolations`         | `SandboxIgnoreViolations` | No       | Violations to ignore |
| `enableWeakerNestedSandbox`| `boolean`                 | No       | Enable weaker nested sandbox |

### SandboxNetwork

| Field               | Type       | Required | Description |
| ------------------- | ---------- | -------- | ----------- |
| `allowLocalBinding` | `boolean`  | No       | Allow binding to local ports |
| `allowUnixSockets`  | `string[]` | No       | Allowed Unix socket paths |
| `allowAllUnixSockets`| `boolean` | No       | Allow all Unix sockets |
| `httpProxyPort`     | `number`   | No       | HTTP proxy port |
| `socksProxyPort`    | `number`   | No       | SOCKS proxy port |

### SandboxIgnoreViolations

| Field     | Type       | Required | Description |
| --------- | ---------- | -------- | ----------- |
| `file`    | `string[]` | No       | File path patterns to ignore |
| `network` | `string[]` | No       | Network patterns to ignore |

```yaml
sandbox:
  enabled: true
  autoAllowBashIfSandboxed: true
  excludedCommands:
    - rm
    - sudo
  network:
    allowLocalBinding: true
    httpProxyPort: 8080
  ignoreViolations:
    file:
      - '/tmp/*'
    network:
      - 'localhost:*'
```

## SettingSource

Enum with values:

| Value     | Description |
| --------- | ----------- |
| `user`    | User-level settings |
| `project` | Project-level settings |
| `local`   | Local settings |

## Environment Variable Interpolation

The configuration supports environment variable interpolation using `${VAR}` syntax:

| Syntax              | Description |
| ------------------- | ----------- |
| `${VAR_NAME}`       | Required - error if not set |
| `${VAR_NAME:-default}` | Optional with default value |

```yaml
mcpServers:
  github:
    env:
      GITHUB_TOKEN: '${GITHUB_TOKEN}'           # Required
      DEBUG: '${DEBUG:-false}'                  # Optional with default
```

## Complete Example

```yaml
version: '2.0'

agents:
  - id: engineer
    name: Engineer
    description: Handles coding tasks and bug fixes
    label: agent
    systemPrompt:
      type: preset
      preset: claude_code
      append: |
        This is the Sniff project. Follow existing patterns.
    runner:
      claude:
        allowedTools:
          - Read
          - Write
          - Edit
          - Glob
          - Grep
          - Bash
        permissionMode: acceptEdits
        maxTurns: 50
        maxBudgetUsd: 10.0
        mcpServers:
          github:
            type: stdio
            command: npx
            args: ["-y", "@modelcontextprotocol/server-github"]
            env:
              GITHUB_TOKEN: '${GITHUB_TOKEN}'
        hooks:
          SessionEnd:
            - hooks:
                - type: command
                  command: 'git status'
        sandbox:
          enabled: true
          autoAllowBashIfSandboxed: true
          excludedCommands:
            - rm -rf
        env:
          NODE_ENV: production
```

## Validation

Validate your configuration with:

```bash
sniff validate
sniff validate -c ./custom-config.yml
```

Common validation errors:

| Error | Cause |
| ----- | ----- |
| Invalid version | Must be exactly `"2.0"` |
| Missing agents | At least one agent required |
| Invalid agent id | Must be lowercase alphanumeric with hyphens |
| Missing runner | Each agent needs a `runner` configuration |
| Invalid MCP server type | Must be `stdio`, `sse`, or `http` |
| Unknown hook event | Hook event name not recognized |
