---
title: Configuration
description: Complete guide to configuring your Sniff agents
---

# Configuration

Your agents are defined in a `sniff.yml` file. This guide covers all configuration options.

## Basic Structure

```yaml
version: '2.0'

agents:
  - id: engineer
    name: Engineer
    label: agent
    systemPrompt: |
      You are a software engineer...
    runner:
      claude:
        allowedTools:
          - Read
          - Write
          - Edit
        permissionMode: acceptEdits
        maxTurns: 50
```

## Environment Variables

Configuration uses environment variables for credentials and settings:

| Variable                | Required | Default | Description |
| ----------------------- | -------- | ------- | ----------- |
| `SNIFF_PROXY_URL`       | Yes      | -       | Your proxy worker URL |
| `SNIFF_PORT`            | No       | 3847    | Local server port |
| `LINEAR_WEBHOOK_SECRET` | No       | -       | Webhook signature verification |
| `SNIFF_WORKTREE_ENABLED`| No       | true    | Enable git worktree isolation |

### Variable Interpolation

Use `${VAR_NAME}` syntax for values that should come from environment:

```yaml
runner:
  claude:
    mcpServers:
      github:
        type: stdio
        command: npx
        args: ["-y", "@modelcontextprotocol/server-github"]
        env:
          GITHUB_TOKEN: '${GITHUB_TOKEN}'
```

Syntax options:

- `${VAR_NAME}` - Required (error if not set)
- `${VAR_NAME:-default}` - Optional with default value

## Agent Fields

### `id` (required)

Unique identifier. Lowercase letters, numbers, and hyphens only.

```yaml
id: engineer
```

### `name` (required)

Display name shown in Linear.

```yaml
name: Engineer
```

### `description` (optional)

Brief description of the agent's purpose.

```yaml
description: Handles coding tasks and bug fixes
```

### `label` (optional)

Filter to only handle issues with this Linear label.

```yaml
label: agent
```

### `team` (optional)

Filter to only handle issues in this Linear team (by team ID).

```yaml
team: TEAM_ID_HERE
```

<Note>Both `label` and `team` are optional filters. If omitted, the agent responds to any delegation or @mention.</Note>

### `systemPrompt` (required)

Instructions that define your agent's behavior. Can be a string or a preset:

**String format:**

```yaml
systemPrompt: |
  You are a software engineer. Help with coding tasks,
  bug fixes, and code reviews. Write clean, tested code.
```

**Preset format:**

```yaml
systemPrompt:
  type: preset
  preset: claude_code
  append: |
    Additional instructions specific to this project...
```

<Tip>Use the `claude_code` preset to get Claude Code's default system prompt, then append project-specific instructions.</Tip>

## Runner Configuration

All execution options go under `runner.claude`:

```yaml
runner:
  claude:
    allowedTools:
      - Read
      - Write
      - Edit
    permissionMode: acceptEdits
    maxTurns: 50
```

### `allowedTools`

List of tools the agent can use. Available tools from Claude Agent SDK:

| Tool | Description |
| ---- | ----------- |
| `Read` | Read file contents |
| `Write` | Create new files |
| `Edit` | Edit existing files |
| `Glob` | Find files by pattern |
| `Grep` | Search file contents |
| `Bash` | Execute shell commands |
| `Task` | Spawn sub-agents |
| `WebFetch` | Fetch web content |
| `WebSearch` | Search the web |

```yaml
allowedTools:
  - Read
  - Write
  - Edit
  - Glob
  - Grep
  - Bash
```

### `disallowedTools`

Explicitly block specific tools:

```yaml
disallowedTools:
  - Bash
  - Task
```

### `model`

Override the default Claude model:

```yaml
model: claude-sonnet-4-20250514
```

### `permissionMode`

Controls how the agent handles tool permissions:

| Mode | Description |
| ---- | ----------- |
| `default` | Standard permission prompts |
| `acceptEdits` | Auto-accept file edits |
| `bypassPermissions` | Skip all permission checks |
| `plan` | Plan-only mode (no execution) |

```yaml
permissionMode: acceptEdits
```

### `maxTurns`

Maximum number of conversation turns:

```yaml
maxTurns: 50
```

### `maxBudgetUsd`

Maximum API spend in USD:

```yaml
maxBudgetUsd: 10.0
```

### `maxThinkingTokens`

Maximum tokens for extended thinking:

```yaml
maxThinkingTokens: 10000
```

### `env`

Agent-specific environment variables:

```yaml
env:
  NODE_ENV: production
  DEBUG: 'false'
```

## MCP Servers

Connect external tools via Model Context Protocol. Three connection types are supported:

### stdio (command-based)

```yaml
mcpServers:
  github:
    type: stdio
    command: npx
    args: ["-y", "@modelcontextprotocol/server-github"]
    env:
      GITHUB_TOKEN: '${GITHUB_TOKEN}'
```

### sse (Server-Sent Events)

```yaml
mcpServers:
  linear:
    type: sse
    url: https://mcp.linear.app/sse
    headers:
      Authorization: 'Bearer ${LINEAR_TOKEN}'
```

### http (HTTP POST)

```yaml
mcpServers:
  custom:
    type: http
    url: https://api.example.com/mcp
    headers:
      X-API-Key: '${API_KEY}'
```

<Note>When authenticated with Linear, the Linear MCP server is automatically injected if not already configured.</Note>

## Hooks

Hooks allow you to run commands at various points in the agent lifecycle:

```yaml
runner:
  claude:
    hooks:
      PreToolUse:
        - matcher: 'Bash'
          hooks:
            - type: command
              command: 'echo "About to run bash command"'
              timeout: 5000
      PostToolUse:
        - hooks:
            - type: command
              command: './scripts/log-tool-use.sh'
      SessionEnd:
        - hooks:
            - type: command
              command: './scripts/cleanup.sh'
```

### Available Hook Events

| Event | Description |
| ----- | ----------- |
| `PreToolUse` | Before a tool is executed |
| `PostToolUse` | After a tool completes |
| `PostToolUseFailure` | After a tool fails |
| `UserPromptSubmit` | When user submits input |
| `Stop` | When agent stops |
| `SubagentStart` | When sub-agent starts |
| `SubagentStop` | When sub-agent stops |
| `PreCompact` | Before context compaction |
| `SessionStart` | When session begins |
| `SessionEnd` | When session ends |
| `Notification` | On notifications |
| `PermissionRequest` | On permission requests |

### Hook Matchers

Use `matcher` to filter which tool invocations trigger the hook:

```yaml
PreToolUse:
  - matcher: 'Bash'  # Only for Bash tool
    hooks:
      - type: command
        command: './validate-command.sh'
  - matcher: 'Edit'  # Only for Edit tool
    hooks:
      - type: command
        command: './backup-file.sh'
```

## Sandbox

Configure sandbox isolation for agent execution:

```yaml
runner:
  claude:
    sandbox:
      enabled: true
      autoAllowBashIfSandboxed: true
      excludedCommands:
        - rm
        - sudo
      network:
        allowLocalBinding: true
        httpProxyPort: 8080
      ignoreViolations:
        file:
          - '/tmp/*'
        network:
          - 'localhost:*'
```

### Sandbox Options

| Option | Type | Description |
| ------ | ---- | ----------- |
| `enabled` | boolean | Enable sandbox mode |
| `autoAllowBashIfSandboxed` | boolean | Auto-allow bash when sandboxed |
| `excludedCommands` | string[] | Commands to block |
| `allowUnsandboxedCommands` | boolean | Allow unsandboxed commands |

### Network Options

| Option | Type | Description |
| ------ | ---- | ----------- |
| `allowLocalBinding` | boolean | Allow binding to local ports |
| `allowUnixSockets` | string[] | Allowed Unix socket paths |
| `httpProxyPort` | number | HTTP proxy port |
| `socksProxyPort` | number | SOCKS proxy port |

### Ignore Violations

| Option | Type | Description |
| ------ | ---- | ----------- |
| `file` | string[] | File path patterns to ignore |
| `network` | string[] | Network patterns to ignore |

## Complete Examples

### Engineering Agent

```yaml
version: '2.0'

agents:
  - id: engineer
    name: Engineer
    label: agent
    systemPrompt: |
      You are a software engineer. Help with coding tasks,
      bug fixes, and code reviews.

      Guidelines:
      - Write clean, well-tested code
      - Follow existing patterns in the codebase
      - Explain your changes clearly
    runner:
      claude:
        allowedTools:
          - Read
          - Write
          - Edit
          - Glob
          - Grep
          - Bash
        permissionMode: acceptEdits
        maxTurns: 50
        mcpServers:
          github:
            type: stdio
            command: npx
            args: ["-y", "@modelcontextprotocol/server-github"]
            env:
              GITHUB_TOKEN: '${GITHUB_TOKEN}'
```

### Triage Agent

```yaml
version: '2.0'

agents:
  - id: triage
    name: Triage Bot
    label: triage
    systemPrompt: |
      You are a triage specialist. Analyze incoming issues and:
      1. Classify as: bug, feature, question, or task
      2. Set priority: P0 (critical) to P3 (low)
      3. Suggest relevant labels
      4. Provide brief reasoning
    runner:
      claude:
        allowedTools:
          - Read
          - Glob
          - Grep
        permissionMode: default
        maxTurns: 10
```

### Multiple Agents

```yaml
version: '2.0'

agents:
  - id: engineer
    name: Engineer
    label: agent
    systemPrompt: |
      You are a software engineer...
    runner:
      claude:
        allowedTools:
          - Read
          - Write
          - Edit
          - Glob
          - Grep
          - Bash
        permissionMode: acceptEdits
        maxTurns: 50

  - id: reviewer
    name: Code Reviewer
    label: review
    team: ENG_TEAM_ID
    systemPrompt: |
      You are a code reviewer...
    runner:
      claude:
        allowedTools:
          - Read
          - Glob
          - Grep
        permissionMode: default
        maxTurns: 20
```

## Validation

Validate your configuration:

```bash
sniff validate
```

Or specify a custom config file:

```bash
sniff validate -c ./my-config.yml
```

## CLI Commands

| Command | Description |
| ------- | ----------- |
| `sniff init` | Create initial sniff.yml |
| `sniff validate` | Validate configuration |
| `sniff auth linear` | Authenticate with Linear |
| `sniff start` | Start the agent server |
| `sniff status` | Check health status |
| `sniff logs` | View execution logs |

## Next Steps

<Card title="Schema Reference" icon="book" href="/schema-reference">
  Complete schema specification with all options
</Card>
